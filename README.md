
# 3D Pose Estimation Using AlphaPose and MotionBERT

This repository contains a setup for 3D pose estimation integrating two powerful models: AlphaPose for 2D pose estimation and MotionBERT for 3D pose estimation. Below are the guidelines for setting up and running the project.

## Prerequisites

Before running the code, make sure to set up the environment by following these guides:

- [AlphaPose Setup Guide](https://github.com/MVIG-SJTU/AlphaPose/tree/master)
- [MotionBERT GitHub Repository](https://github.com/Walter0807/MotionBERT/tree/main)
- [Additional AlphaPose Setup Instructions](https://blog.csdn.net/weixin_44848751/article/details/132140935)

Ensure that all necessary libraries are installed and that the model weights are correctly placed in their respective directories as detailed in the GitHub repositories.

## Project Structure

- **AlphaPose Folder**: Contains the modified AlphaPose code from the [AlphaPose GitHub](https://github.com/MVIG-SJTU/AlphaPose/tree/master).
- **MotionBERT Folder**: Contains the MotionBERT code from the [MotionBERT GitHub](https://github.com/Walter0807/MotionBERT/tree/main).
- **Data**: This directory includes several subfolders:
  - **Original Video**: Place your videos here.
  - **Ground Truth**: Contains ground truth JSON files.
  - **AlphaPose 2D Output**: Stores the JSON output generated by AlphaPose.
  - **Trimmed Videos**: Stores the first 10 seconds of the original videos, trimmed.
  - **MotionBERT 3D Output**: Stores the 3D NPY files generated by MotionBERT.
  - **Ground Truth Calculated Angles**: Excel files containing ground truth angles for each exercise and consolidated.
  - **MotionBERT Calculated Angles**: Excel files containing angles calculated by MotionBERT for each exercise and consolidated.

## Running the Code

1. **Set Up Environment**: Follow the above guides to install necessary libraries and place model weights.
2. **Prepare Data**: Add your videos and JSON ground truth files to `Data/riginal Video` and `Data/Ground Truth` respectively.
3. **Run AlphaPose**:
   - Navigate to the AlphaPose folder.
   - Modify input-output directories in `main.py`.
   - Execute `main.py`. It processes the first 10 seconds (approximately 503 frames) of each video, outputting JSON files to `Data/AlphaPose 2D Output`.
4. **Run MotionBERT**:
   - Navigate to the MotionBERT folder.
   - Adjust directories in the main script.
   - Execute the script to generate 3D pose output (NPY files) from 2D JSON outputs, stored in `Data/MotionBERT 3D Output`.
5. **Calculate Angles**:
   - Execute `Calculate Angles.py` to compute various angles. Outputs are stored in the Data folder.
6. **Evaluate MPJAE**:
   - Run `Calculate MPJAE.py` to calculate the Mean Per Joint Angle Error (MPJAE) between ground truth and MotionBERT's results.

## Contributions

Feel free to fork this repository and submit pull requests or propose changes via issues.
